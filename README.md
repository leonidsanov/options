# Моделирование распределения доходностей финансовых активов и оценка опционов

Распределение доходностей активов подчиняется закону распределения абсолютно непрерывной случайной величины, поэтому задача моделирования распределения доходностей состоит в том, чтобы определить к какому классу абсолютно непрерывных распределений случайной величины относится данное конкретное изучаемое распределение доходностей конкретного актива, индекса или финансового инструмента. Если мы правильно подберём распределение, то можно будет понять какому закону подчиняется данная случайная величина и таким образом сможем контролировать риск и доходность.

*Как оценить распределение доходностей?*

*Как определить параметры функции распределения, чтобы оно наилучшим возможным образом соответствовало данным?*

## Функция распределения

Функция распределения - ключевой термин из теории вероятностей. Используется в экономике/финансах для моделирования элемента случайности. Функция распределения $F(x)$ характеризует некоторый закон распределения $F$.

Предположим, дневная доходность акции является случайной величиной, подчиняющейся закону $F$. Тогда $F(x)$ - вероятность, что доходность акции в определённый день не превысит $x$%. Что тогда значит F(1%) = 70%? Эта запись означает, что в какой-то конкретный день с вероятностью 70% доходность не превысит 1%.

$F(x)$ может быть любой математической функцией, если она возрастает и ограничена отрезком [0;1]. $f(x)$ - функция плотности распределения, является первой производной от (кумулятивной) функции распределения $F(x)$.

*Зачем нужны распределения?*

Статистические распределения имеют множество финансовых приложений.
**Риск-менеджмент:** если знать, какому закону распределения подчиняется доходность портфеля, можно определить, насколько вероятны убытки и каковы будут потери в определённом сценарии (логика value-at-risk - стоимостной меры риска)

**Портфельный менеджмент:** знание распределения доходностей позволяет более точно определить оптимальный портфель для инвестора с точки зрения риск/доходность или максимизации функции полезности

**Оценка справедливой стоимости:** определение корректного закона распределения важно для оценки многих финансовых инструментов (например, опционов).

*Какие бывают распределения?*

Самое широко распространенное в моделях - нормальное распределение

Используется в: value-at-risk, портфельной теории Марковица, модели кредитного риска Мертона, модели Блэка-Шоулза для оценки опционов, функции полезности инвестора Эрроу-Пратта, модели пробита и т.д.

Мы рассмотрим шесть распределений:
1) Нормальное
2) Лапласа
3) Гиперсекант
4) Коши
5) Стьюдента
6) Логистическое

### Нормальное распределение

Функция плотности вероятности:

$f(x) = \frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$

Однозначно задается средним и СКО (среднеквадратичное отклонение)

Эксцесс=0 ("плоские" хвосты). Мала вероятность экстремальных значений.

Экстремальные значения маловероятны

У нормального распределения самая высокая энтропия.

### Логистическое распределение

Функция распределения:

$F(x)=\frac{1}{1+e^{-(\frac{\chi-\mu}{a})}}$

Функция плотности вероятности:

$f(x)=\frac{e^{-(\frac{\chi-\mu}{a})}}{a(1+e^{-(\frac{\chi-\mu}{a})})^{2}}$

Эксцесс=6/5

Оценка параметров (ММ (метод моментов)): простое среднее и

$\sigma^{2}=\frac{a^{2}\pi^{2}}{3}\implies a=\frac{\sigma\sqrt{3}}{\pi}$

### Гиперболический секант

Функция распределения:

$F(x)=\frac{2}{\pi} \arctan(e^{\frac{\pi}{2}(\frac{\chi-\mu}{\sigma})})$

Функция плотности вероятности:

$f(x)=\frac{1}{2\sigma}sech(\frac{\pi}{2}(\frac{\chi-\mu}{\sigma}))$

Эксцесс=2

Оценка параметров (ММ): среднее и СКО

### Распределение Лапласа

Функция распределения:

$F(x) = \begin{cases}\frac{1}{2}e^{(\frac{x-m}{b})}, x \leq m\\1-\frac{1}{2}e^{-\frac{x-m}{b}}, x > m\end{cases}$

Функция плотности распределения:

$f(x)=\frac{1}{2b}e^{-\frac{|x-m|}{b}}$

Эксцесс=3

Оценка параметров (ММП (метод максимального правдоподобия)): медиана и среднее абсолютное значение

### Распределение Стьюдента

Задаётся степенями свободы $(df)$
Эксцесс (kurtosis) - какой угодно!

$kurt=\frac{6}{df-4}$

$\sigma^{2}=\frac{df}{df-2}s^{2}$

Оценка параметров (ММ):

$df=\frac{6}{kurt}+4$

$s=\sigma\sqrt{\frac{df-2}{df}}$

### Распределение Коши

Функция распределения:

$F(x)=\frac{1}{\pi}\arctan(\frac{\chi-m}{\gamma})+\frac{1}{2}$

$f(x)=\frac{1}{\pi\gamma(1+(\frac{\chi-m}{\gamma})^{2})}$

Эксцесс, дисперсия - не определены, среднее - бесконечно!

Оценка параметров (ММ): медиана и разброс между квартилями

$\gamma=\frac{q(0.75)-q(0.25)}{2}$

## *Как оценить распределение?*

*Как определить параметры функции распределения, чтобы оно наилучшим возможным образом соответствовало данным?*

1) Метод моментов: подогнать параметры так, чтобы статистические моменты (среднее, дисперсия, скошенность и/или эксцесс) совпадали
2) Метод максимального правдоподобия: максимизировать функцию

$L=\displaystyle\prod_{i=1}^{n} f(\chi_{i})$

или, что эквивалентно, функцию:

$\log L=\displaystyle\sum_{i=1}^{n}\log(f(\chi_{i}))$

## *Как проверить распределение?*

*Как проверить, насколько хорошо функция распределения соответствует реальным данным?*

Один из подходов - критерий Колмогорова-Смирнова:
Вычислить супремум - наибольшее абсолютное отклонение от эмпирической функции распределения:

$S=max_{i}|F(\chi_{i})-F^{*}(\chi_{i})|$

Вычислить р-значение по формуле:

$p=e^{-S^{2}n}$

р-значение - вероятность, что эмпирическое распределение подчиняется обозначенному теоретическому закону (убывает с $S$ и $n$)

Переходим в Python!